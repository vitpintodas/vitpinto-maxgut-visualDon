<!-- graphique Walter White -->
<!DOCTYPE html>
<html>  
  <head>
    <title>Walter White</title>
  </head>

</html>
<meta charset="utf-8">

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<!-- Create a div where the graph will take place -->
<div id="my_dataviz"></div>


<script>


// création de l'espace graphique SVG
var svg = d3.select("body")
  .append("svg")
  .attr("width", 500)
  .attr("height", 400);

// lecture des données CSV
d3.csv("data2.csv", function(data) {//ici le nom du fichier csv utilisé et son chemin pour y accéder depuis ce fichier
  
  // filtre les données pour le personnage "Walter White"
  var filteredData = data.filter(function(d) { return d.name === "Walter White"; });//changer le nom ici pour avoir le graph d'un autre personnage
  
  // extraction des données de victimes pour chaque saison
  var seasons = ["Saison 1", "Saison 2", "Saison 3", "Saison 4", "Saison 5"];
  var victimData = [];
  seasons.forEach(function(season) {
    victimData.push(parseInt(filteredData[0][season]));
  });
  
  // échelles de l'axe x et de l'axe y
  var xScale = d3.scaleBand()
    .domain(seasons)
    .range([50, 450])
    .padding(0.2);
  var yScale = d3.scaleLinear()
    .domain([0, d3.max(victimData)])
    .range([350, 50]);
  
  // création de l'axe x et de l'axe y
  var xAxis = d3.axisBottom(xScale);
  var yAxis = d3.axisLeft(yScale);
  svg.append("g")
    .attr("transform", "translate(0, 350)")
    .call(xAxis);
  svg.append("g")
    .attr("transform", "translate(50, 0)")
    .call(yAxis);

    // ajout du nom de l'axe Y
svg.append("text")
  .attr("transform", "rotate(-90)")
  .attr("y", 0)
  .attr("x", -200)
  .attr("dy", "1em")
  .style("text-anchor", "middle")
  .text("Nombre de morts");

// ajout du nom de l'axe X
svg.append("text")
  .attr("y", 380)
  .attr("x", 225)
  .attr("dy", "1em")
  .style("text-anchor", "middle")
  .text("Saison");
  
  // création des barres
  svg.selectAll("rect")
  .data(victimData)
  .enter()
  .append("rect")
  .attr("x", function(d, i) { return xScale(seasons[i]); })
  .attr("y", function(d) { return yScale(d); })
  .attr("width", xScale.bandwidth())
  .attr("height", function(d) { return 350 - yScale(d); })
  .attr("rx", 5)
  .attr("ry", 5)
  .on("mouseover", function(d, i) {
    d3.select(this)
      .transition()
      .duration(200)
      .attr("fill", "yellow");
    svg.append("text")
      .attr('class', 'value')
      .attr('x', xScale(seasons[i]) + xScale.bandwidth() / 2)
      .attr('y', yScale(d) - 10)
      .attr('text-anchor', 'middle')
      .text(d);
  })
  .on("mouseout", function(d) {
    d3.select(this)
      .transition()
      .duration(200)
      .attr("fill", "#0e1117");
    svg.selectAll('.value').remove();
  });
});

</script>

<style>
  text {
    font-family: Arial, sans-serif;
  }
</style>